package notifications

import "time"

func (v *VulnerabilityNotification) GetGUID() string {
	return v.GUID
}

func (v *VulnerabilityNotification) SetGUID(guid string) {
	v.GUID = guid
}

func (v *VulnerabilityNotification) GetCreationTime() *time.Time {
	if v.CreationTime == "" {
		return nil
	}
	creationTime, err := time.Parse(time.RFC3339, v.CreationTime)
	if err != nil {
		return nil
	}
	return &creationTime
}

func (v *VulnerabilityNotification) SetUpdatedTime(updatedTime *time.Time) {
	if updatedTime == nil {
		v.UpdatedTime = time.Now().UTC().Format(time.RFC3339)
		return
	}
	v.UpdatedTime = updatedTime.UTC().Format(time.RFC3339)
}

func (v *VulnerabilityNotification) GetUpdatedTime() *time.Time {
	if v.UpdatedTime == "" {
		return nil
	}
	updatedTime, err := time.Parse(time.RFC3339, v.UpdatedTime)
	if err != nil {
		return nil
	}
	return &updatedTime
}
