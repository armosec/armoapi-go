package notifications

import "github.com/armosec/armoapi-go/armotypes"

// AggregatedVulnerability represent a vulnerability event (new vulnerability or new fix) in a namespace
type AggregatedVulnerability struct {
	GUID             string                `json:"guid,omitempty" bson:"guid,omitempty"`
	NotificationType NotificationType      `json:"notificationType,omitempty" bson:"notificationType,omitempty"`
	CVEID            string                `json:"cveID,omitempty" bson:"cveID,omitempty"` // name of cve
	VulnerabilityID  string                `json:"vulnerabilityID,omitempty" bson:"vulnerabilityID,omitempty"`
	Description      string                `json:"description,omitempty" bson:"description,omitempty"`
	Severity         int                   `json:"severity,omitempty" bson:"severity,omitempty"`
	SeverityName     string                `json:"severityName,omitempty" bson:"severityName,omitempty"`
	Cluster          string                `json:"cluster,omitempty" bson:"cluster,omitempty"`
	ClusterShortName string                `json:"clusterShortName,omitempty" bson:"clusterShortName,omitempty"`
	Namespace        string                `json:"namespace,omitempty" bson:"namespace,omitempty"`
	Workloads        []string              `json:"workloads,omitempty" bson:"workloads,omitempty"`
	Images           []string              `json:"images,omitempty" bson:"images,omitempty"`
	WLIDS            []string              `json:"wlids,omitempty" bson:"wlids,omitempty"`
	CVELink          string                `json:"cveLink,omitempty" bson:"cveLink,omitempty"`
	Fixable          bool                  `json:"fixable" bson:"fixable"`
	Package          string                `json:"package,omitempty" bson:"package,omitempty"`
	PackageVersion   string                `json:"packageVersion,omitempty" bson:"packageVersion,omitempty"`
	FixVersion       string                `json:"fixVersion,omitempty" bson:"fixVersion,omitempty"`
	CreationTime     string                `json:"creationTime,omitempty" bson:"creationTime,omitempty"`
	UpdatedTime      string                `json:"updatedTime,omitempty" bson:"updatedTime,omitempty"`
	Exploitable      string                `json:"exploitable,omitempty" bson:"exploitable,omitempty"`
	IsRelevant       string                `json:"isRelevant,omitempty" bson:"isRelevant,omitempty"`
	CVSSBaseScore    float64               `json:"cvssBaseScore"`
	CVSSScoreVersion string                `json:"cvssScoreVersion"`
	CvssInfo         armotypes.CvssInfo    `json:"cvssInfo,omitempty" bson:"cvssInfo,omitempty"`
	EpssInfo         armotypes.EpssInfo    `json:"epssInfo,omitempty" bson:"epssInfo,omitempty"`
	CisaKevInfo      armotypes.CisaKevInfo `json:"cisaKevInfo,omitempty" bson:"cisaKevInfo,omitempty"`
}

// type VulnerabilitiesComponentShort struct {
// 	Name        string `json:"name"`
// 	Version     string `json:"version"`
// 	PackageType string `json:"packageType"`
// 	FixVersion  string `json:"fixVersion"`
// 	IsRelevant  string `json:"isRelevant"` // in use
// }
